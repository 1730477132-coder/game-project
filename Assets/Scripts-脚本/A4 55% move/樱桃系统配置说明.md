# 樱桃系统配置说明

## 脚本说明

### CherryController.cs
- **功能**: 控制樱桃的移动逻辑
- **移动方式**: 使用线性Lerp从一侧穿到另一侧
- **特点**: 无视碰撞，直线穿屏移动

### CherrySpawner.cs  
- **功能**: 控制樱桃的生成逻辑
- **生成时机**: 场景开始5秒后生成第一个，每次樱桃被销毁后再等5秒生成
- **生成位置**: 关卡边界外的随机位置

## 樱桃预制体设置要求

### 1. 碰撞设置
为了确保樱桃无视墙体/豆子/鬼的碰撞，需要设置：

**Collider2D组件设置:**
- 添加 `Collider2D` 组件（推荐使用 `CircleCollider2D`）
- 勾选 `Is Trigger` = true
- 设置 `Layer` 为专门的樱桃层（如 "Cherry"）

**Layer设置:**
- 在 `Edit > Project Settings > Tags and Layers` 中创建新层 "Cherry"
- 确保樱桃层不与以下层发生碰撞：
  - Wall层（墙体）
  - Pellet层（豆子）  
  - Ghost层（鬼）
  - PacStudent层（玩家）

**Physics2D设置:**
- 在 `Edit > Project Settings > Physics2D` 中
- 取消勾选 Cherry 层与其他层的碰撞矩阵

### 2. 渲染层级设置
为了确保樱桃绘制层级高于其他精灵：

**SpriteRenderer组件设置:**
- `Sorting Layer` = "UI" 或 "Foreground"（比游戏对象更高的层级）
- `Order in Layer` = 10（确保在大多数对象之上）

**Sorting Layer设置:**
- 在 `Edit > Project Settings > Tags and Layers` 中
- 确保 Cherry 的 Sorting Layer 优先级高于：
  - Default
  - Background  
  - Gameplay
  - 其他游戏对象层

### 3. 玩家收集检测
为了检测玩家收集樱桃，需要在PacStudent上添加触发器检测：

**PacStudent设置:**
- 确保PacStudent有 `Collider2D` 组件
- 在PacStudent脚本中添加：

```csharp
void OnTriggerEnter2D(Collider2D other)
{
    if (other.CompareTag("Cherry"))
    {
        CherryController cherry = other.GetComponent<CherryController>();
        if (cherry)
        {
            cherry.OnCollected();
            // 这里可以添加得分逻辑
        }
    }
}
```

### 4. 樱桃预制体标签
- 给樱桃预制体添加 `Cherry` 标签
- 在 `Edit > Project Settings > Tags and Layers` 中创建 "Cherry" 标签

## 使用步骤

1. **创建樱桃预制体:**
   - 创建空的GameObject
   - 添加SpriteRenderer组件，设置樱桃图片
   - 添加CircleCollider2D组件，设置为Trigger
   - 添加CherryController脚本
   - 设置Layer为"Cherry"，Tag为"Cherry"
   - 设置Sorting Layer为"UI"，Order in Layer为10
   - 保存为预制体

2. **设置生成器:**
   - 在场景中创建空的GameObject
   - 添加CherrySpawner脚本
   - 将樱桃预制体拖入Cherry Prefab字段
   - 设置关卡中心点和边界范围
   - 调整生成间隔和移动速度

3. **配置物理设置:**
   - 在Project Settings中设置Layer碰撞矩阵
   - 确保樱桃层不与墙体、豆子、鬼发生碰撞

## 参数调整

### CherryController参数:
- `moveSpeed`: 樱桃移动速度
- `levelBounds`: 关卡边界范围
- `cameraMargin`: 超出相机范围的距离

### CherrySpawner参数:
- `spawnInterval`: 生成间隔时间（默认5秒）
- `spawnOffset`: 生成边界偏移
- `cherryMoveSpeed`: 樱桃移动速度
- `directionRange`: 移动方向变化范围

## 调试功能

- 在Scene视图中选中CherrySpawner可以看到关卡边界和生成边界的Gizmos
- 选中CherryController可以看到移动路径的Gizmos
- 使用CherrySpawner的"立即生成樱桃"上下文菜单可以测试生成功能
